<div class="container">
  <div class="header" style="display: flex;justify-content: space-between; align-items: center;">
    <span>
      <img src="./assets/logo.png" style="height: 60px;" alt="">
    </span>
    <div style="font-size: 1.5rem;">
      <i class="bi bi-clock"></i>
      {{ date | date:'MMM dd, YYYY, hh:mm aa'}}
    </div>
    <div>
      <span>
        <button (click)="show=!show" style="width: 100px;margin-top: 5px;" class="btn btn-primary">{{show==true?'Hide':'Undo'}}</button>
      </span>
      <span style="float: right;padding-right: 10px; padding-top: 5px;">
        <input type="file" id="upload" accept="application/JSON" (change)="fileChanged($event)" hidden />
        <label class="btn btn-primary" for="upload"><i class="bi bi-upload"></i> Upload</label>
      </span>
      <span>
        <button (click)="downloadJson()" class="btn btn-primary" style="margin-top: 5px"><i class="bi bi-download"></i> Download</button>
      </span>
      <span>
        <button (click)="updateHeaders()" class="btn btn-primary" style="margin-top: 5px"><i class="bi bi-arrow-clockwise"></i> Refresh Data</button>
      </span>
      <span style="float: right">
        <button (click)="clearForToday()" class="btn btn-primary" style="margin-top: 5px"><i class="bi bi-eraser-fill"></i> Clear</button>
      </span>
    </div>
  </div>
  
  <div [hidden]="!show" class="subheader" style="grid-column-start:1;grid-column-end:2;background-color: rgb(249, 235, 233);">
    <div style="color: black; font-size: 18px;">GT</div>
    <div>
      {{currentGT | currency:'INR':'symbol':'.0'}}
    </div>
  </div>
  <div [hidden]="!show" class="subheader subheader2" style="grid-column-start:2;grid-column-end:6;background-color: #EDC2D8FF;">
    <div>
      <div style="color: black; font-size: 18px;">In Hand</div>
      <div style="font-size: 25px;"> {{currentDenom|currency:'INR':'symbol':'.0'}}</div>
    </div>
    <div>
      <div style="color: black; font-size: 18px;">Bank</div>
      <div style="font-size: 25px;"> {{currentAccountSum-currentDenom |currency:'INR':'symbol':'.0'}}</div>
    </div>
    <div>
      <div style="color: black; font-size: 18px;">EC</div>
      <div style="font-size: 25px;"> {{currentServicesSum|currency:'INR':'symbol':'.0'}}</div>
    </div>
    <div>
      <div style="color: black; font-size: 18px;">Cust. Bal</div>
      <div style="font-size: 25px;"> {{currentCrBal|currency:'INR':'symbol':'.0'}}</div>
    </div>
  </div>
  <div  [hidden]="!show" class="subheader subheader3" style="background-color: rgb(224, 240, 254);grid-column-start:6;grid-column-end:8">
    <div>
      <div style="color: black; font-size: 18px;">DR</div>
      <div style="font-size: 25px; color: red;"> {{currentDebBal|currency:'INR':'symbol':'.0'}}</div>
    </div>

    <div>
      <div style="color: black; font-size: 18px;">Exp</div>
      <div style="font-size: 25px; color:red"> {{currentExpenses|currency:'INR':'symbol':'.0'}}</div>
    </div>
    
  </div>

  <div  [hidden]="!show" class="subheader" [style.color]="currentDiff>=0?'green':'red'" style="background-color: rgb(255, 235, 245); grid-column-start:8;grid-column-end:10">
    <div style="color: black; font-size: 18px;">Diff</div>
    {{currentDiff |currency:'INR':'symbol':'.0'}}
  </div>

  <!--Sub Header Ends-->

  <div class="main1" style="grid-column-start:1;grid-column-end:5; margin: 5px;">
    <div>
      <div *ngFor="let a of accounts">
        <span style="display: flex;">
          <label data-toggle="tooltip" data-placement="top" title="Yesterday Amount : {{a.yestAmount}}" style="width: 150px;align-self: center;" for="id_{{a.id}}">{{a.name}}</label>
          <input #ip [disabled]="ip.id=='id_accounts-1'?true:false" (focusout)="onChange($event,'accounts')" class="inputstyle form-control" type="number" id="id_{{a.id}}" value="{{a.amount}}">
        </span>
      </div>
    </div>

    <div>

      <div *ngFor="let a of services">
        <span style="display: flex;">
          <label data-toggle="tooltip" data-placement="top" title="Yesterday Amount : {{a.yestAmount}}" style="width: 150px;align-self: center;" for="id_{{a.id}}">{{a.name}}</label>
          <input (focusout)="onChange($event,'services')" class="inputstyle form-control"  value="{{a.amount}}"  type="number" id="id_{{a.id}}">
        </span>
      </div>
    </div>
  </div>
  <div style="grid-column-start:5;grid-column-end:8; margin: 5px;">
    <div class="main2" >
      <div class="cr">
        Credit
        <span style="float: right;padding-right: 5px;">
          <button (click)="addUser('cr')" class="btn btn-primary" style="margin: 0px;"><i class="bi bi-person-plus"></i> Add</button>
        </span>

      </div>
      <div>  
        <div *ngFor="let a of crPeoples;index as i">
          <span style="display: grid; grid-template-columns: 1fr auto 40px;">
            <label style="margin-right: 20px;align-self: center;overflow: hidden;" for="id_{{a.custName}}_{{a.type}}">{{i+1}}. {{a.custName}}</label>
            <input  value="{{a.amount}}" (focusout)="onChange($event,'cust-c')"  class="inputstyle form-control" type="number" id="id_{{a.custName}}_{{a.type}}" value="{{a.amount}}">
            <button class="btn btn-danger" style="margin: 2px; margin-bottom: 2px;width: 40px;" (click)="deleteRow(a.custName,'cr');updateHeaders()">-</button>
          </span>
        </div>
      </div>
      <div class="cr" (click)="addUser('dr')">
        <span>Debit</span>
        <span style="float: right;padding-right: 5px;">
          <button class="btn btn-primary" style="margin: 0px;"><i class="bi bi-person-plus"></i> Add</button>
        </span>
      </div>
      <div>
        <div *ngFor="let a of drPeoples;index as i">
          <span style="display: grid; grid-template-columns: 1fr auto 40px;">
            <label style="margin-right: 20px;align-self: center;" for="id_{{a.custName}}_{{a.type}}">{{i+1}}. {{a.custName}}</label>
            <input (focusout)="onChange($event,'cust-d')"  value="{{a.amount}}" class="inputstyle form-control" type="number" id="id_{{a.custName}}_{{a.type}}" value="{{a.amount}}">
            <button class="btn btn-danger" style="margin: 2px; margin-bottom: 2px;width: 40px;" (click)="deleteRow(a.custName,'dr');updateHeaders()">-</button>
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="maincontent4" style="grid-column-start:8;grid-column-end:10;">
    <div>
      <div *ngFor="let a of cashBal">
        <span style="display: flex; flex-direction: row-reverse;">
          <input (focusout)="onChange($event,'denom')"  value="{{a.value}}" class="inputstyle form-control" type="number" id="id_{{a.id}}" >
          <label style="margin-right: 20px;width: 100px;align-self: center;" for="id_{{a.id}}">{{a.denom}} X</label>
        </span>
      </div>
    </div>

    <div class="cr">
      <span style="text-align: center;">Expenses</span>
      <span style="float: right;padding-right: 5px;">
        <button class="btn btn-primary" (click)="addUser('ex')" style="margin: 0px;"><i class="bi bi-plus"></i> Add</button>
      </span>
    </div>

    <div>
      <div *ngFor="let a of expenses;index as i">
        <span style="display: grid; grid-template-columns: 1fr auto 40px;">
          <label style="margin-right: 20px;align-self: center;" for="id_{{a.name}}_ex">{{i+1}}. {{a.name}}</label>
          <input (focusout)="onChange($event,'expense')" value="{{a.amount}}" class="inputstyle form-control" style="width: 120px;" type="number" id="id_{{a.name}}_ex">
          <button  class="btn btn-danger" style="margin: 2px; margin-bottom: 2px;width: 40px;" (click)="deleteRow(a.name,'ex');updateHeaders()">-</button>
        </span>
      </div>
    </div>

  </div>
</div>

<footer (click)="updateGT()" >Yesterday GT : {{yestGT}} | Yesterday Diff : {{yestDiff}} | Report Downloaded Time : {{yestDate | date:'medium'}} <span style="position: fixed; right: 10px; cursor: pointer;" (click)="clearCache($event)">Clear Cache</span></footer>